{
 "cells": [
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "# üìò Gravitational Transform Tutorial\n",
    "\n",
    "This tutorial demonstrates how to use the **Gravitational Transform**, a reversible mapping between:\n",
    "\n",
    "**Text ‚Üí Fourier Transform ‚Üí Gravitational Orbits ‚Üí Evolution ‚Üí Inverse Transform ‚Üí Text**\n",
    "\n",
    "We will cover:\n",
    "\n",
    "1. **Encoding text as numerical signals**\n",
    "2. **Computing Fourier coefficients**\n",
    "3. **Mapping FFT amplitudes + phases to orbital systems**\n",
    "4. **Evolving the system using N-body gravitational simulation**\n",
    "5. **Visualizing the system (circles + trails)**\n",
    "6. **Inverse transforming back into text**\n",
    "7. **Exploring time-dependent message drift**\n",
    "\n",
    "This notebook assumes the following modules exist in your project:\n",
    "\n",
    "- `gt.pipeline_forward`\n",
    "- `gt.pipeline_inverse`\n",
    "- `gt.visualization.fourier_animation`\n",
    "- `gt.simulation.nbody`\n",
    "\n",
    "Let's begin! üöÄ"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "## 1. Import dependencies\n",
    "\n",
    "We import the forward transform, inverse transform, and visualization tools."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {},
   "outputs": [],
   "source": [
    "import numpy as np\n",
    "from gt.pipeline_forward import forward_transform\n",
    "from gt.pipeline_inverse import inverse_transform\n",
    "from gt.visualization.fourier_animation import animate_fourier_orbits\n",
    "import matplotlib.pyplot as plt"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "## 2. Encoding a sentence\n",
    "The transform takes a **numerical signal**, so we convert any input string into an array of ASCII values."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {},
   "outputs": [],
   "source": [
    "def encode_text(text: str):\n",
    "    return np.array([ord(c) for c in text], dtype=float)\n",
    "\n",
    "encode_text(\"hello world\")"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "## 3. Forward Transform: Text ‚Üí Fourier ‚Üí Orbits ‚Üí Evolution\n",
    "\n",
    "This performs the **Option B** nonlinear-radius Fourier mapping.\n",
    "\n",
    "It returns:\n",
    "- `positions_over_time`: shape `(steps, N, 2)`\n",
    "- `meta`: metadata needed for inversion\n",
    "\n",
    "Let's apply it to a simple sentence:"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {},
   "outputs": [],
   "source": [
    "text = \"hello world\"\n",
    "signal = encode_text(text)\n",
    "\n",
    "positions, meta = forward_transform(signal, steps=2000, dt=0.01)\n",
    "positions.shape, meta"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "## 4. Visualizing the Gravitational Transform\n",
    "\n",
    "Use this cell to animate the result.\n",
    "This will pop up a TkAgg animation window.\n",
    "\n",
    "**NOTE:** If running in Jupyter Lab, ensure your backend supports interactive windows.\n",
    "If not, you can switch to inline animations later."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {},
   "outputs": [],
   "source": [
    "# Uncomment to animate\n",
    "# animate_fourier_orbits(positions, meta)"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "## 5. Inverse Transform: Orbits ‚Üí Fourier ‚Üí Text\n",
    "\n",
    "The inverse transform lets us decode the system at **any time index**.\n",
    "\n",
    "Let's decode at **t = 0** (should reconstruct perfectly):"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {},
   "outputs": [],
   "source": [
    "decoded_t0 = inverse_transform(positions, meta, t_index=0)\n",
    "decoded_t0"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "Now try decoding at later times to see how gravitational interactions distort the message."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {},
   "outputs": [],
   "source": [
    "decoded_t200 = inverse_transform(positions, meta, t_index=200)\n",
    "decoded_t800 = inverse_transform(positions, meta, t_index=800)\n",
    "decoded_t1500 = inverse_transform(positions, meta, t_index=1500)\n",
    "\n",
    "decoded_t200, decoded_t800, decoded_t1500"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "## 6. Plotting Orbital Snapshots\n",
    "\n",
    "Sometimes it's helpful to see the **positions** at a given time without full animation.\n",
    "\n",
    "We can plot the system at any frame:"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {},
   "outputs": [],
   "source": [
    "def plot_frame(positions, t):\n",
    "    pos = positions[t]\n",
    "    x = pos[:,0]\n",
    "    y = pos[:,1]\n",
    "\n",
    "    plt.figure(figsize=(6,6))\n",
    "    plt.scatter(x[1:], y[1:], s=30)\n",
    "    plt.scatter([0],[0], s=80, color='orange')\n",
    "    plt.title(f\"Orbital state at t = {t}\")\n",
    "    plt.axis('equal')\n",
    "    plt.show()\n",
    "\n",
    "plot_frame(positions, 200)"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "# 7. Interesting Experiments\n",
    "Here are some examples you can run to explore the system."
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "### 7.1 Compare two sentences\n",
    "See how orbit systems differ."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {},
   "outputs": [],
   "source": [
    "sentences = [\"hello world\", \"hello worle\", \"goodbye world\"]\n",
    "\n",
    "for s in sentences:\n",
    "    sig = encode_text(s)\n",
    "    pos, meta = forward_transform(sig, steps=800)\n",
    "    print(f\"Sentence: {s}\")\n",
    "    print(\"Decoded at t=400:\", inverse_transform(pos, meta, t_index=400))\n",
    "    print()"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "### 7.2 Time-evolving poem lines\n",
    "Try evolving lyrical or poetic text:"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {},
   "outputs": [],
   "source": [
    "line = \"the stars whisper forgotten songs\"\n",
    "sig = encode_text(line)\n",
    "pos, meta = forward_transform(sig, steps=2000)\n",
    "\n",
    "for t in [0, 200, 600, 1200, 1800]:\n",
    "    print(f\"t={t}: {inverse_transform(pos, meta, t_index=t)}\")"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "### 7.3 Visualizing divergence between frames\n",
    "We can measure how fast orbital geometry diverges."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {},
   "outputs": [],
   "source": [
    "def divergence(positions, t1, t2):\n",
    "    pos1 = positions[t1,1:]\n",
    "    pos2 = positions[t2,1:]\n",
    "    return np.linalg.norm(pos1 - pos2, axis=1).mean()\n",
    "\n",
    "for t in [10, 50, 100, 200, 400, 800]:\n",
    "    print(f\"Divergence(0 ‚Üí {t}):\", divergence(positions, 0, t))"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "# ‚úîÔ∏è Summary\n",
    "\n",
    "In this tutorial, you learned how to:\n",
    "\n",
    "### üîπ Encode text into Fourier spectra\n",
    "### üîπ Map FFT modes to a gravitational N-body system\n",
    "### üîπ Animate orbits with trails and circular guides\n",
    "### üîπ Use radius + angle to reconstruct Fourier coefficients\n",
    "### üîπ Decode the evolved system back into a modified sentence\n",
    "### üîπ Explore time-dependent message drift and divergence\n",
    "\n",
    "This creates a reversible (but time-sensitive) **gravitational information transform**.\n",
    "\n",
    "If you'd like, I can also generate:\n",
    "- a version with interactive sliders\n",
    "- MP4/GIF export tools\n",
    "- a 3D gravitational transform\n",
    "- a chaos-sensitivity analysis\n",
    "\n",
    "Just ask!"
   ]
  }
 ],
 "metadata": {
  "kernelspec": {
   "display_name": "Python 3",
   "language": "python",
   "name": "python3"
  },
  "language_info": {
   "name": "python",
   "version": "3.11"
  }
 },
 "nbformat": 4,
 "nbformat_minor": 5
}
